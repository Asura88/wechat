#  Linux Rootkit对抗无从下手？LinuxAR给出答案

原创 深瞻情报实验室  [ 深信服千里目安全技术中心 ](javascript:void\(0\);)

**深信服千里目安全技术中心** ![]()

微信号 gh_c644c6e98b08

功能介绍
深信服千里目安全技术中心专注网络安全各技术领域研究及应用，囊括六大技术实验室和一个创新研究院，聚焦国内外漏洞、攻防对抗技术、终端安全、高级威胁、威胁情报等安全技术领域专业研究，最终赋能于产品。

____

___发表于_

收录于合集 #高级持续威胁追踪 60个

![]()

_**01**_

 **序言**  

长期稳定运行的服务器，就一定没有失陷吗？

偶尔宕机的服务器，重启就能解决问题吗？

使用卡顿但监控健康的服务器，维护一下继续用吗？

小心，这很可能已经被网络犯罪组织控制……

 _ **02**_

 **什么是Linux Rootkit**

90年代初期，Rootkit 用于攻击 Unix 系统以获得最大权限并以 root 用户身份执行命令，因此得名。

  

 **Rootkit主要任务是隐藏并长期驻留在感染机器上的从事各类恶意活动，达到高隐藏高持久化目的。**

  

 **Rootkit 技术由来已久，发展历久弥新，呈现从简单到复杂、高层向低层的演化趋势，其技术演化的核心思想是劫持。**

  

Linux 平台下，安全研究员围绕着劫持对象和劫持方式，产生出了非常多的底层Rootkit技术。下图为，Linux Rootkit常见的劫持对象与劫持技术。

  

![]()

  

根据Linux Rootkit运行时权限级别划分为用户态和内核态两种。

  

Linux用户态 Rootkit
所需的前置知识和复杂度，与内核态Rootkit相比更简单，更容易开发，因此常用于大范围攻击。它所涉及的技术简单且成熟，可以拦截系统调用并替换 API
或劫持应用程序返回的值，以获得对设备的控制。

  

Linux内核态 Rootkit 具有与操作系统相同的权限，在内核级别运行，通常作为设备驱动程序或可加载模块加载到目标设备中。

  

内核态 Rootkit 很难开发，因为源代码中的任何错误都会影响目标系统的稳定性，这将是发现恶意程序的最直接表现。

 _ **03**_

 **为什么Rootkit难处置**

深瞻情报实验室，近两年对黑产组织攻击事件猎捕与监测分析发现，越来越多的黑产组织转战Linux平台，以某些开源Linux内核态Rootkit为基础，结合用户态恶意程序，从事网络犯罪活动。

  

2023年，我们监控到活跃的SkidMap挖矿家族使用的Rootkit实施新的挖矿窃密事件。

 **此次Skidmap组织Rootkit攻击事件，攻击路径和方式相较于以前更加复杂，** 通过植入内核态Rootkit隐藏文件、进程等；

  

![]()

  

用户态替换tty、agetty、umount、PAM动态链接库；

阻止busybox、unhide、csysdig等监控和取证工具执行、阻止新的内核模块加载等方式，对抗取证调查。

  

![]()

  

当用户登录使用命令进行排查时，新的恶意进程会再次拉起，内核态Rootkit重新加载，继续执行恶意活动。

  

此次攻击事件中，不仅植入Rootkit隐藏文件、进程等，而且大部分恶意文件都在执行后删除，尽可能地做到“无文件攻击”。

  

深瞻情报实验室事件调查过程中发现Skidmap组织攻击目的，不局限于挖矿，还包含窃取密码，以便于持久化控制，用于间谍活动。

  

Linux Rootkit攻击事件往往具有 **高隐藏高持久化** 的特点，由于业内对内核态Rootkit的检测和处置能力较低，
**攻击者可以“肆无忌惮”地开展任何恶意活动。**

 **  
**

一款制作精良的Rootkit可以在受害主机长期驻留稳定运行，历史上披露的Linux Rootkit攻击事件，大多数是由于攻击者的 **疏忽和贪心**
，用户态的痕迹并未全部隐藏，比如，配置文件遗漏、特定目录遗漏、连接黑域名等痕迹， **从而暴露恶意活动。**

 **  
**

 **常规Rootkit 检测** 方式存在很 **明显局限性** ，比如，用户态痕迹yara规则检测或视图交叉对比检测，攻击者很低的成本
**绕过其检测。**

 **  
**

当前Linux内核态Rootkit的数量在逐渐增多，Rootkit 攻击也呈现上升趋势，而长期以来业内缺乏对Linux 内核态Rootkit的
**检测、取证、处置的有效手段。**

 **  
**

当 **安全分析师** 响应Linux Rootkit攻击事件时，一旦
**攻击者使用Rootkit技术针对性对抗取证调查，即使发现了主机异常，往往也是束手无策，最后无奈重装服务器。**

 **  
**

Linux Rootkit攻防两端存在极大不平衡，给予了攻击者可乘之机。

 _ **04**_

 **Rootkit攻防如何破局？LinuxAR给出答案！**

深瞻情报实验室与终端安全团队合作研发LinuxAR（Linux AnitRootkit）系列引擎——LinuxAR引擎支持已知与未知的内核态 Rootkit
检测，并且已经作为MSS服务的工具发布，能够支持 Rootkit 取证与处置，实现导出内核内存数据，方便取证分析，处置常见的
Rootkit，恢复恶意隐藏行为，帮助安全分析师响应内核态 Rootkit 攻击事件时不会无从下手，快速应对，顺利完成事件取证调查。

  

![]()

  

深瞻情报实验室响应Skidmap组织Rootkit攻击事件，使用LinuxAR工具遏制Rootkit攻击，清除主机异常，发现被隐藏的其他恶意活动。处置Rootkit后，外连恶意进程最终暴露：

  

![]()

  

隐藏的挖矿进程暴露：

  

![]()

 _ **05**_

 **深信服解决方案**

 **【深信服安全托管服务MSS】**
以保障用户网络安全“持续有效”为目标，通过将用户安全设备接入安全运营中心，依托于XDR安全能力平台和MSSP安全服务平台实现有效协同的“人机共智”模式，围绕资产、脆弱性、威胁、事件四个要素为用户提供7*24H的安全运营服务，快速扩展持续有效的安全运营能力，保障可承诺的风险管控效果。

 _ **06**_

 **联系我们**

深信服深瞻情报实验室专注全球高级威胁事件的跟踪与分析，拥有一套完善的自动化分析溯源系统以及外部威胁监控系统，能够快速精准的对APT组织使用的攻击样本进行自动化分析和关联，同时积累并完善了几十个APT以及网络犯罪威胁组织的详细画像，成功帮助客户应急响应处置过多起APT及网络犯罪威胁组织攻击事件。

如何在不断升级的APT威胁对抗中保持先机？知己知彼方能百战不殆。全面了解APT组织，一整个拿捏住！深信服深瞻情报实验室正式推出APT组织画像平台（戳此体验https://sec.sangfor.com.cn/apt）！

![]()

预览时标签不可点

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

